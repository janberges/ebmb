\documentclass[twocolumn]{article}

\usepackage[margin=1cm, includefoot, heightrounded]{geometry}

\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

\usepackage[math]{iwona}
\usepackage{inconsolata}
\usepackage[T1]{fontenc}

\usepackage{mathtools}
\usepackage[labelfont=bf]{caption}
\usepackage[hidelinks]{hyperref}

\setcounter{topnumber}{1}
\setcounter{bottomnumber}{1}

\def\textfraction{0.1}
\def\topfraction{0.9}
\def\bottomfraction{0.9}
\def\floatpagefraction{0.9}

\def\D{\mathrm d}
\def\E{\mathrm e}
\def\I{\mathrm i}

\def\sub#1{\sb{\mathrm{#1}}}
\def\from#1{\sb{\mathrlap{#1}}}
\def\till#1{\sp{\mathrlap{#1}}}

\let\vec\boldsymbol
\let\epsilon\varepsilon
\let\Delta\varDelta
\let\Sigma\varSigma
\let\Theta\varTheta

\def\Re{\mathrm{Re}}
\def\Im{\mathrm{Im}}

\newlength\gap
\setlength\gap{1ex}

\let\vol\textbf
\let\name\textsc
\let\dtype\textsc

\def\dummy#1{$\langle$#1$\rangle$}

\title{\tt EB\_local}
\author{Jan Berges}

\begin{document}
   \maketitle

   \section{Outline}

   This  program  solves  the   \name{Eliashberg}  equations  for  local  ($\vec
   k$-independent)  self-energies  on a  cut-off  imaginary  frequency axis  and
   optionally  continues   the  results  to   the  real  axis   via  \name{Padé}
   approximants.

   A  material  is  defined  by  nothing  but  a  single  phonon  frequency,  an
   electron-phonon coupling parameter, a \name{Coulomb} pseudo-potential and, if
   desired, the density of \name{Bloch} states,  which is assumed to be constant
   by default.

   If no temperature is  given, it is assumed to be  critical and determined via
   the bisection method.

   \section{Installation}

   Simply run \verb|make|, provided recent versions of Fortran compiler and Make
   utility are installed. Compiler preferences may be adjusted in the Makefile.

   \section{Implemented formulas}

   \subsection{\textsc{Eliashberg} theory}

   Units are chosen in which $\hbar = k \sub B = 1$.

   The quantity of interest is the  electronic self-energy matrix as part of the
   \name{Nambu} formalism,\footnote{Y.  \name{Nambu}, Phys. Rev.  \vol{117}, 648
   (1960)} which  is assumed to  be local, i.e.  independent of the  wave vector
   $\vec k$. It may be written in  terms of unit and \name{Pauli} matrices, thus
   on the imaginary frequency axis
   %
   \begin{align*}
      \vec \Sigma(\I \omega_n) &=
      \I \omega_n [1 - Z(\I \omega_n)] \vec{\mathit 1}
      + \phi(\I \omega_n) \vec \sigma_1
      + \chi(\I \omega_n) \vec \sigma_3,
   \end{align*}
   %
   where  the temperature  $T$ enters  through the  fermionic \name{Matsu\-bara}
   frequencies $\omega_n = (2 n +  1) \pi T$. The renormalization function $Z(\I
   \omega_n)$, the order parameter  of superconductivity $\phi(\I \omega_n)$ and
   the energy shift $\chi(\I \omega_n)$  are determined by the \name{Eliashberg}
   equations\footnote{G. M.  \name{Eliashberg}, Soviet Phys. JETP  \vol{11}, 696
   (1960).  A  comprehensive review  is  given  by  P.  B. \name{Allen}  and  B.
   \name{Mitrović} in Solid state physics \vol{37} (1982)}
   %
   \begin{align}
      \begin{split}
         Z(\I \omega_n) &= 1 + \frac T {\omega_n} \sum_m
         \int \from{-\infty} \till \infty \D \epsilon \frac{n(\epsilon)}{n(0)}
         \frac{\omega_m Z (\I \omega_m)}{\Theta_m(\epsilon)}
         \lambda(\omega_n - \omega_m),
         \\
         \phi(\I \omega_n) &= T \sum_m
         \int \from{-\infty} \till \infty \D \epsilon \frac{n(\epsilon)}{n(0)}
         \frac{\phi(\I \omega_m)}{\Theta_m(\epsilon)}
         [\lambda(\omega_n - \omega_m) - \mu^*(\omega \sub c)],
         \\
         \chi(\I \omega_n) &= -T \sum_m
         \int \from{-\infty} \till \infty \D \epsilon \frac{n(\epsilon)}{n(0)}
         \frac{\epsilon + \chi(\I \omega_m)}{\Theta_m(\epsilon)}
         \lambda(\omega_n - \omega_m),
         \\
         \Theta_n(\epsilon) &= [\omega_n Z(\I \omega_n)]^2
         + \phi^2(\I \omega_n) + [\epsilon + \chi(\I \omega_n)]^2.
      \end{split}
      \label{Eliashberg full}
   \end{align}
   %
   The  series is  cut-off at  a certain  frequency $\omega  \sub c$,  thus only
   integers $m$ with $|\omega_m| < \omega \sub c$ are summed over. $n(\epsilon)$
   is  the  density of  \name{Bloch}  states,  where  the energy  $\epsilon$  is
   measured  relative to  the \name{Fermi}  level. The  electron-phonon coupling
   strength   $\lambda(\omega)$   and    the   \name{Coulomb}   pseudo-potential
   $\mu^*(\omega \sub  c)$ are connected  to the corresponding variables  of the
   critical temperature
   %
   \begin{align}
      T \sub c = \frac{\omega \sub E}{1.2}
      \exp \frac{1.04 \, (1 + \lambda)}{\mu^* + 0.62 \, \mu^* \lambda - \lambda}
      \label{TcMD}
   \end{align}
   %
   according  to  \name{McMillan}\footnote{W.  L.  \name{McMillan},  Phys.  Rev.
   \vol{167}, 331  (1968)} and  \name{Dynes}\footnote{R. C.  \name{Dynes}, Solid
   State Commun. \vol{10}, 615 (1972)} via
   %
   \begin{align*}
      \lambda(\omega) = \frac \lambda
      {1 + \big[ \frac \omega {\omega \sub E} \big]^2}
      \quad \text{and} \quad
      \mu^*(\omega \sub c) = \frac {\mu^*}
      {1 + \mu^* \ln \frac{\omega \sub E}{\omega \sub c}},
   \end{align*}
   %
   where $\omega \sub E$ is the single \name{Einstein} phonon frequency.

   Since the  integrand in  Eq.~\ref{Eliashberg full}  is very  small everywhere
   except  near the  \name{Fermi}  level,  $n(\epsilon)$ may  be  replaced by  a
   constant  $n(0)$ which  yields $\chi(\I  \omega_n)  = 0$  and the  simplified
   \name{Eliashberg} equations
   %
   \begin{align}
      \begin{split}
         Z(\I \omega_n) &= 1 + \frac{\pi T}{\omega_n} \sum_m
         \frac{\omega_m}{E_m}
         \lambda(\omega_n - \omega_m),
         \\
         \Delta(\I \omega_n) &= \frac{\pi T}{Z(\I \omega_n)} \sum_m
         \frac{\Delta(\I \omega_m)}{E_m}
         [\lambda(\omega_n - \omega_m) - \mu^*(\omega \sub c)],
         \\
         E_n &= \sqrt{\omega_n^2 + \Delta^2(\I \omega_n)},
         \quad \text{where} \quad
         \Delta(\I \omega_n) = \frac{\phi(\I \omega_n)}{Z(\I \omega_n)}.
      \end{split}
      \label{Eliashberg simple}
   \end{align}
   %
   The latter the energy gap of the superconducting state.

   \subsection{Continuation to real axis}

   Numerically,  the analytical  continuation  from the  imaginary  to the  real
   frequency axis is applied to the \name{Padé} approximant
   %
   \begin{align*}
      \vec \Sigma(\omega) = \dfrac{c_1 \, \phantom{(\omega - \I \omega_0)}}
      {1 + \dfrac{c_2 \, (\omega - \I \omega_0)}
      {1 + \dfrac{c_3 \, (\omega - \I \omega_1)} \dots}},
   \end{align*}
   %
   where  the coefficients  are chosen  so that  all imaginary-axis  results are
   reproduced.\footnote{H.  J. \name{Vidberg}  and J.  W. \name{Serene},  J. Low
   Temp. Phys. \vol{29}, 179 (1977)}

   \section{Application}

   \subsection{Input}

   \begin{table}
      \centering
      \begin{tabular}{r @{\,} *2l}
         \verb|10| & K & temperature $T$ (critical if \verb|-1|) \\
         [\gap]
         \verb|1e-10| & eV & negligible gap $\Delta(\I \omega_0)$ \\
         \verb|1e-10| & K & error of critical temperature \\
         [\gap]
         \verb|0.02| & eV & \name{Einstein} frequency $\omega \sub E$ \\
         \verb|1.00| && electron-phonon coupling $\lambda$ \\
         \verb|0.15| && \name{Coulomb} pseudo-potential $\mu^*$ \\
         [\gap]
         \verb|none| && file with density of \name{Bloch} states $n(\epsilon)$
            (or \verb|none|) \\
         [\gap]
         \verb|10| & $\omega \sub E$
            & overall cutoff frequency $\omega \sub c$\\
         \verb|-1| & $\omega \sub E$
            & \name{Coulomb} cutoff frequency (absent if \verb|-1|) \\
         [\gap]
         \verb|100000| && maximum number of fixed-point steps \\
         [\gap]
         \verb|true| && find measurable gap $\Delta_0$? \\
         \verb|300| && real axis resolution \\
         [\gap]
         \verb|both| && output format
            (\verb|text|, \verb|data| or \verb|both|) \\
         \verb|true| && include parameters in output file? \\
         [\gap]
         \verb|1e-15| & a.u. & negligible float difference
      \end{tabular}
      \caption{Exemplary input file}
      \label{input}
   \end{table}
   %
   The names of  the parameter files to be processed  are passed as command-line
   arguments.  The required  file  format is  exemplified in  Table~\ref{input},
   whereby the following remarks have to be made:
   %
   \begin{itemize}
      \item Everything but  the first number or  word of each non-empty  line is
            ignored (i.e. taken as comment).
            %
      \item $\omega \sub E$,  $\lambda$ and $\mu^*$ are  understood as variables
            of the critical temperature according to Eq.~\ref{TcMD}.
            %
      \item The file with the density of \name{Bloch} states shall begin with an
            integer  $n$ followed  by  $n$  lines with  one  sample point  each:
            $\epsilon$, ascending, on  the left, $n(\epsilon)$ on  the right. If
            \verb|none| is given, Eqs.~\ref{Eliashberg simple} are used in place
            of Eqs.~\ref{Eliashberg full}.
            %
      \item If a \name{Coulomb}  cutoff frequency is given,  it replaces $\omega
            \sub c$ in  $\mu^*(\omega \sub c)$, which in turn  is only preserved
            in  terms with  a lower  absolute frequency  in Eqs.~\ref{Eliashberg
            full} or \ref{Eliashberg simple}.
            %
      \item Numerical  self-consistency is  defined with  respect to  negligible
            float differences.
   \end{itemize}

   \subsection{Output}

   The  output  files  are  named  after  the  corresponding  input  files  with
   \verb|.out| (human-readable  format) or \verb|.dat| (binary  format) added or
   replacing the existing extension.

   \begin{table}[b]
      \centering
      \begin{tabular}{r l}
         \dummy{\dtype{string} name}\verb|:|\rlap{%
         \dummy{$n_1 \times \hdots \times n_d$ \dtype{numbers} data}} & \\
         & associate name with data \\
         [\gap]
         \verb|DIM:|\rlap{%
         \dummy{\dtype{integer} $d$}%
         \dummy{$d$ \dtype{integers} $n_1 \dots n_d$}} & \\
         & define shape (column-major) \\
         [\gap]
         \verb|INT:| & take \dtype{numbers} as \dtype{integers} \\
         [\gap]
         \verb|REAL:| & take \dtype{numbers} as \dtype{doubles}
      \end{tabular}
      \caption{Statements for binary output}
      \label{output}
   \end{table}
   %
   Binary output is  suitable if further processing of the  results is intended.
   Since the internal  data representation is preserved, it is  lossless but not
   necessarily  platform-independent.  The  allowed statements  are  defined  in
   Table~\ref{output}. There are no default values.

   \begin{table}[b]
      \centering
      \begin{tabular}{r l}
         \verb|chi| & imaginary-axis energy shift $\chi(\I \omega_n)$ \\
         \verb|cutoff| & index of \name{Coulomb} cutoff frequency \\
         \verb|Delta| & imaginary-axis gap $\Delta(\I \omega_n)$ \\
         \verb|Delta0| & measurable gap $\Delta_0 = \Re[\Delta(\Delta_0)]$ \\
         \verb|density| & density of \name{Bloch} states $n(\epsilon)$ \\
         \verb|energy| & energy $\epsilon$ relative to the \name{Fermi} level \\
         \verb|epsilon| & negligible float difference \\
         \verb|error| & error of \name{Eliashberg}'s $T \sub c$ \\
         \verb|Im[Delta]| & imag. part of real-axis gap $\Im[\Delta(\omega)]$ \\
         \verb|Im[Z]| & imag. part of real-axis renorm. $\Im[Z(\omega)]$ \\
         \verb|Im[chi]| & imag. part of real-axis shift $\Im[\chi(\omega)]$ \\
         \verb|iomega| & \name{Matsubara} frequency $\omega_n$ (without $\I$) \\
         \verb|lambda| & electron-phonon coupling $\lambda$ \\
         \verb|limit| & maximum number of fixed-point steps \\
         \verb|mu*EB| & \name{Eliashberg}'s $\mu^*(\omega \sub c)$ \\
         \verb|mu*MD| & \name{McMillan} and \name{Dynes}' $\mu^*$ \\
         \verb|omega| & real frequency $\omega$ \\
         \verb|omegaE| & \name{Einstein} frequency $\omega \sub E$ \\
         \verb|phiC|
            & constant \name{Coulomb} contribution to $\phi(\I \omega_n)$ \\
         \verb|Re[Delta]| & real part of real-axis gap $\Re[\Delta(\omega)]$ \\
         \verb|Re[Z]| & real part of real-axis renorm. $\Re[Z(\omega)]$ \\
         \verb|Re[chi]| & real part of real-axis shift $\Re[\chi(\omega)]$ \\
         \verb|small| & negligible gap $\Delta(\I \omega_0)$ \\
         \verb|status| & status (steps till convergence or $-1$) \\
         \verb|status0| & status of $\Delta_0$ \\
         \verb|T| & temperature $T$ \\
         \verb|TcEB| & \name{Eliashberg}'s $T \sub c$ \\
         \verb|TcMD| & \name{McMillan} and \name{Dynes}' $T \sub c$ \\
         \verb|Z| & imaginary-axis renormalization $Z(\I \omega_n)$
      \end{tabular}
      \caption{Identifiers used in binary output}
      \label{identifiers}
   \end{table}
   %
   The data identifiers actually used are listed in Table~\ref{identifiers}. Not
   all of them are present for all settings.

   \subsection{Python interface}

   The Python  module provides wrapper  functions to generate  parameters files,
   run the main program and load the results into NumPy arrays.

   If SciPy is  installed, files with densities of \name{Bloch}  states may also
   be created. Currently, only square lattices with nearest-neighbor hopping are
   implemented.

   \section{Acknowledgment}

   Parts   of   the  program   are   inspired   by  the   EPW   code\footnote{F.
   \name{Giustino},  M. L.  \name{Cohen} and  S. G.  \name{Louie}, Phys.  Rev. B
   \vol{76},  165108  (2007)  for  a  methodology  review.  Results  related  to
   \name{Eliashberg}  theory  are  presented  by E.  R.  \name{Margine}  and  F.
   \name{Giustino},  Phys. Rev.  B \vol{87},  024505 (2013)}  and work  of Malte
   Rösner.

   \section{Contact}

   Any feedback may be directed to \href
   {mailto:jan.berges@uni-bremen.de?subject=Feedback%20EB_local}
   {\tt jan.berges@uni-bremen.de}.
\end{document}